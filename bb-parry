local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Workspace = game:GetService("Workspace")

-- Vizuální indikátor dosahu
local function createVisualIndicator()
    local character = LocalPlayer.Character
    if not character or not character:FindFirstChild("HumanoidRootPart") then return end

    local visualIndicator = Instance.new("Part")
    visualIndicator.Name = "VisualIndicator"
    visualIndicator.Size = Vector3.new(1, 1, 1) -- Malá velikost, upravíme velikost podle potřeby
    visualIndicator.Anchored = true
    visualIndicator.CanCollide = false
    visualIndicator.BrickColor = BrickColor.new("Bright red")
    visualIndicator.Transparency = 0.5
    visualIndicator.Parent = Workspace
    visualIndicator.CFrame = character.HumanoidRootPart.CFrame * CFrame.new(0, 0, -5) -- Startovní pozice

    return visualIndicator
end

local visualIndicator = createVisualIndicator()

-- Funkce pro aktualizaci velikosti a pozice vizuálního indikátoru
local function updateVisualIndicator(radius)
    if not visualIndicator then return end
    visualIndicator.Size = Vector3.new(radius * 2, 1, radius * 2)
    visualIndicator.CFrame = LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, -radius)
end

-- Funkce pro automatické kliknutí na tlačítko BLOCK
local function clickBlockButton()
    local blockButton = LocalPlayer.PlayerGui:FindFirstChild("BlockButton")
    if blockButton and blockButton:IsA("GuiButton") then
        blockButton.MouseButton1Click:Fire() -- Simulace kliknutí na tlačítko
    end
end

-- Funkce pro detekci červeného míče
local function isRedBall(ball)
    if ball and ball:IsA("Part") and ball.Color == Color3.fromRGB(255, 0, 0) then
        return true
    end
    return false
end

-- Funkce pro kontrolu, zda je míč poblíž
local function isBallNear(ball, radius)
    if ball and ball:IsA("Part") then
        local ballPosition = ball.Position
        local playerPosition = LocalPlayer.Character.HumanoidRootPart.Position
        local distance = (ballPosition - playerPosition).magnitude
        return distance < radius
    end
    return false
end

-- Funkce pro výpočet rychlosti míče
local function getBallSpeed(ball)
    if ball and ball:IsA("Part") and ball:FindFirstChild("Velocity") then
        return ball.Velocity.magnitude
    end
    return 0
end

-- Funkce pro nalezení červeného míče poblíž a přizpůsobení dosahu
local function findAndHandleRedBall()
    local maxDistance = 10 -- Startovní hodnota dosahu, měníme podle rychlosti míče
    for _, object in pairs(Workspace:GetChildren()) do
        if isRedBall(object) and isBallNear(object, maxDistance) then
            -- Při detekci míče upravíme dosah podle rychlosti míče
            local ballSpeed = getBallSpeed(object)
            local newRadius = math.min(ballSpeed / 10, 20) -- Přizpůsobíme maximální dosah
            updateVisualIndicator(newRadius)
            clickBlockButton() -- Klikni na tlačítko BLOCK
            break -- Pokud je míč zpracován, není třeba pokračovat ve hledání
        end
    end
end

-- Hlavní smyčka pro kontrolu míče a klikání
RunService.RenderStepped:Connect(function()
    findAndHandleRedBall()
end)
