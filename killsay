local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- Funkce pro teleportaci hráče za záda nepřítele
local function teleportBehindEnemy(enemy)
    if enemy and enemy.Character and enemy.Character:FindFirstChild("HumanoidRootPart") then
        local enemyPosition = enemy.Character.HumanoidRootPart.Position
        local offset = enemy.Character.HumanoidRootPart.CFrame.lookVector * -5
        LocalPlayer.Character:SetPrimaryPartCFrame(CFrame.new(enemyPosition + offset))
    end
end

-- Funkce pro automatické zaměření na hlavu
local function aimAtHead(enemy)
    if enemy and enemy.Character and enemy.Character:FindFirstChild("Head") then
        local headPosition = enemy.Character.Head.Position
        local camera = workspace.CurrentCamera
        camera.CFrame = CFrame.new(camera.CFrame.Position, headPosition)
    end
end

-- Funkce pro automatické střílení
local function autoShoot()
    -- Simulace stisknutí levého tlačítka myši
    UserInputService.InputBegan:Fire(Enum.UserInputType.MouseButton1)
    wait(0.1)  -- Počkáme trochu, abychom simulovali krátké stisknutí
    UserInputService.InputEnded:Fire(Enum.UserInputType.MouseButton1)
end

-- Funkce pro automatické zabití nepřítele
local function killEnemy(enemy)
    if enemy and enemy.Character and enemy.Character:FindFirstChild("Humanoid") then
        local humanoid = enemy.Character.Humanoid
        if humanoid.Health > 0 then
            autoShoot()
        end
    end
end

-- Funkce pro nalezení nejbližšího nepřítele
local function findNearestEnemy()
    local nearestEnemy = nil
    local shortestDistance = math.huge

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Team ~= LocalPlayer.Team and player.Character and player.Character:FindFirstChild("Humanoid") then
            local distance = (LocalPlayer.Character.HumanoidRootPart.Position - player.Character.HumanoidRootPart.Position).magnitude
            if distance < shortestDistance then
                shortestDistance = distance
                nearestEnemy = player
            end
        end
    end

    return nearestEnemy
end

-- Hlavní smyčka, která se spustí na každého nepřítele
RunService.RenderStepped:Connect(function()
    local enemy = findNearestEnemy()
    if enemy then
        teleportBehindEnemy(enemy)
        aimAtHead(enemy)
        killEnemy(enemy)
    end
end)
