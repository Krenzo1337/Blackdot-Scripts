local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local Mouse = LocalPlayer:GetMouse()

-- Funkce pro teleportaci hráče za záda nepřítele
local function teleportBehindEnemy(enemy)
    if enemy and enemy.Character and enemy.Character:FindFirstChild("HumanoidRootPart") then
        local enemyPosition = enemy.Character.HumanoidRootPart.Position
        local offset = enemy.Character.HumanoidRootPart.CFrame.lookVector * -5
        LocalPlayer.Character:SetPrimaryPartCFrame(CFrame.new(enemyPosition + offset))
    end
end

-- Funkce pro automatické zaměření na hlavu
local function aimAtHead(enemy)
    if enemy and enemy.Character and enemy.Character:FindFirstChild("Head") then
        local headPosition = enemy.Character.Head.Position
        Mouse.Hit = CFrame.new(headPosition)
    end
end

-- Funkce pro automatické střílení
local function autoShoot()
    local virtualUser = game:GetService("VirtualUser")
    virtualUser:Button1Down(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
    wait(0.1)  -- Počkáme trochu, abychom simulovali krátké stisknutí
    virtualUser:Button1Up(Vector2.new(0,0), workspace.CurrentCamera.CFrame)
end

-- Funkce pro automatické zabití nepřítele
local function killEnemy(enemy)
    if enemy and enemy.Character and enemy.Character:FindFirstChild("Humanoid") then
        aimAtHead(enemy)
        autoShoot()
    end
end

-- Funkce pro nalezení nejbližšího nepřítele
local function findNearestEnemy()
    local nearestEnemy = nil
    local shortestDistance = math.huge

    for _, player in pairs(Players:GetPlayers()) do
        if player ~= LocalPlayer and player.Team ~= LocalPlayer.Team and player.Character and player.Character:FindFirstChild("Humanoid") then
            local distance = (LocalPlayer.Character.HumanoidRootPart.Position - player.Character.HumanoidRootPart.Position).magnitude
            if distance < shortestDistance then
                shortestDistance = distance
                nearestEnemy = player
            end
        end
    end

    return nearestEnemy
end

-- Hlavní smyčka, která se spustí na každého nepřítele
RunService.RenderStepped:Connect(function()
    local enemy = findNearestEnemy()
    if enemy then
        teleportBehindEnemy(enemy)
        killEnemy(enemy)
    end
end)
